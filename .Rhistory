# load required packages
library(here)
library(plyr)
library(ggplot2)
library(tidyverse)
library(ez)
# load source functions
source(here::here('scr', 'isolate_data.R'))
source(here::here('scr', 'summarySE.R'))
# load data
dt <- read.csv(here::here('data', 'varydelay_data.csv'))
# isolate gamble data
gd <- isolate_data(dt, c(1,8), 32:67)
gd <- gd[complete.cases(gd),]
# restructure data for analysis
d0 <- gather(gd, "gambletype", "choice", X1d_1:X10y_005)
d0$delay <- as.factor(t(as.data.frame(strsplit(d0$gambletype, '_')))[,1])
d0$kval <- as.factor(t(as.data.frame(strsplit(d0$gambletype, '_')))[,2])
d0$delay_unit <- ifelse(str_detect(d0$delay, 'd'), 'days',
ifelse(str_detect(d0$delay, 'w'), 'weeks',
ifelse(str_detect(d0$delay, 'm'), 'months',
ifelse(str_detect(d0$delay, 'y'), 'years', 0))))
## Center age
d0$Age <- scale(d0$Age, center = TRUE, scale=TRUE)
# 3 (kval) x 4 (delay_unit) x Age Within-Subjects ANCOVA
m1 <- ezANOVA(data = d0, dv = .(choice), wid = .(ID), within = .(delay_unit, kval), between = .(Age))
d1 <- gather(gd, "gambletype", "choice", X1d_1:X10y_005)
d1$delay <- as.factor(t(as.data.frame(strsplit(d0$gambletype, '_')))[,1])
d1$kval <- as.factor(t(as.data.frame(strsplit(d0$gambletype, '_')))[,2])
d1$delay_n_days <- ifelse(str_detect(d0$delay, 'd'), '1',
ifelse(str_detect(d0$delay, 'w'), '7',
ifelse(str_detect(d0$delay, 'm'), '30',
ifelse(str_detect(d0$delay, 'y'), '365', 0))))
# load required packages
library(here)
library(plyr)
library(ggplot2)
# load required packages
library(here)
library(plyr)
library(ggplot2)
library(tidyverse)
library(ez)
# load source functions
source(here::here('scr', 'isolate_data.R'))
getwd()
setwd('../github/varyDelay')
getwd()
# load required packages
library(here)
library(plyr)
library(ggplot2)
library(tidyverse)
library(ez)
# load source functions
source(here::here('scr', 'isolate_data.R'))
# load required packages
library(here)
library(plyr)
library(ggplot2)
library(tidyverse)
library(ez)
# load source functions
source(here::here('scr', 'isolate_data.R'))
source(here::here('scr', 'summarySE.R'))
# load data
dt <- read.csv(here::here('data', 'varydelay_data.csv'))
# isolate gamble data
gd <- isolate_data(dt, c(1,8), 32:67)
gd <- gd[complete.cases(gd),]
# restructure data for analysis
d0 <- gather(gd, "gambletype", "choice", X1d_1:X10y_005)
d0$delay <- as.factor(t(as.data.frame(strsplit(d0$gambletype, '_')))[,1])
d0$kval <- as.factor(t(as.data.frame(strsplit(d0$gambletype, '_')))[,2])
d0$delay_unit <- ifelse(str_detect(d0$delay, 'd'), 'days',
ifelse(str_detect(d0$delay, 'w'), 'weeks',
ifelse(str_detect(d0$delay, 'm'), 'months',
ifelse(str_detect(d0$delay, 'y'), 'years', 0))))
## Center age
d0$Age <- scale(d0$Age, center = TRUE, scale=TRUE)
# 3 (kval) x 4 (delay_unit) x Age Within-Subjects ANCOVA
m1 <- ezANOVA(data = d0, dv = .(choice), wid = .(ID), within = .(delay_unit, kval), between = .(Age))
d1 <- gather(gd, "gambletype", "choice", X1d_1:X10y_005)
d1$delay <- as.factor(t(as.data.frame(strsplit(d0$gambletype, '_')))[,1])
d1$kval <- as.factor(t(as.data.frame(strsplit(d0$gambletype, '_')))[,2])
d1$delay_n_days <- ifelse(str_detect(d0$delay, 'd'), '1',
ifelse(str_detect(d0$delay, 'w'), '7',
ifelse(str_detect(d0$delay, 'm'), '30',
ifelse(str_detect(d0$delay, 'y'), '365', 0))))
View(dt)
View(d1)
View(d1)
View(d0)
d1$delaym <- str_remove_all(d1$delay, "[Xdwmy]")
d1$delayND <- as.numeric(d1$delay_n_days)
d1$delayM <- as.numeric(d1$delaym)
d1$choice <- as.numeric(d1$choice)
d1$delay_n_days <- d1$delayM*d1$delayND
d1 <- d1[, -which(names(d1) %in% c("delaym", "delayND", "delayM", "DelayDays", "gambletype", "delay"))]
d1$delay_n_days <- str_replace(d1$delay_n_days, "28", "30")
d1$delay_n_days <-str_replace(d1$delay_n_days, "360", "365")
d1$choice <- str_replace(d1$choice, "1", "0")
d1$choice <- str_replace(d1$choice, "2", "1")
View(d1)
View(d1)
View(d1)
# load required packages
library(here)
library(plyr)
library(ggplot2)
library(tidyverse)
library(ez)
# load source functions
source(here::here('scr', 'isolate_data.R'))
source(here::here('scr', 'summarySE.R'))
# load data
dt <- read.csv(here::here('data', 'varydelay_data.csv'))
# isolate gamble data
gd <- isolate_data(dt, c(1,8), 32:67)
gd <- gd[complete.cases(gd),]
# restructure data for analysis
d0 <- gather(gd, "gambletype", "choice", X1d_1:X10y_005)
d0$delay <- as.factor(t(as.data.frame(strsplit(d0$gambletype, '_')))[,1])
d0$kval <- as.factor(t(as.data.frame(strsplit(d0$gambletype, '_')))[,2])
d0$delay_unit <- ifelse(str_detect(d0$delay, 'd'), 'days',
ifelse(str_detect(d0$delay, 'w'), 'weeks',
ifelse(str_detect(d0$delay, 'm'), 'months',
ifelse(str_detect(d0$delay, 'y'), 'years', 0))))
## Center age
d0$Age <- scale(d0$Age, center = TRUE, scale=TRUE)
# 3 (kval) x 4 (delay_unit) x Age Within-Subjects ANCOVA
m1 <- ezANOVA(data = d0, dv = .(choice), wid = .(ID), within = .(delay_unit, kval), between = .(Age))
d1 <- gather(gd, "gambletype", "choice", X1d_1:X10y_005)
d1$delay <- as.factor(t(as.data.frame(strsplit(d0$gambletype, '_')))[,1])
d1$kval <- as.factor(t(as.data.frame(strsplit(d0$gambletype, '_')))[,2])
d1$delay_n_days <- ifelse(str_detect(d0$delay, 'd'), '1',
ifelse(str_detect(d0$delay, 'w'), '7',
ifelse(str_detect(d0$delay, 'm'), '30',
ifelse(str_detect(d0$delay, 'y'), '365', 0))))
d1$delaym <- str_remove_all(d1$delay, "[Xdwmy]")
d1$delayND <- as.numeric(d1$delay_n_days)
d1$delayM <- as.numeric(d1$delaym)
d1$choice <- as.numeric(d1$choice)
d1$delay_n_days <- d1$delayM*d1$delayND
d1 <- d1[, -which(names(d1) %in% c("delaym", "delayND", "delayM", "DelayDays","delay"))]
d1$delay_n_days <- str_replace(d1$delay_n_days, "28", "30")
d1$delay_n_days <-str_replace(d1$delay_n_days, "360", "365")
d1$choice <- str_replace(d1$choice, "1", "0")
d1$choice <- str_replace(d1$choice, "2", "1")
M2 <- glm(d1$choice~d1$Age+d1$kval+d1$delay_n_days,family=binomial(link='logit'), data = d1)
View(d1)
d2 <- gd[,c(1, 2, 9:14, 18:23, 27:32)]
d2 <- gather(d2, "gambletype", "choice", X7d_1:X1y_1)
d2$delay <- as.factor(t(as.data.frame(strsplit(d2$gambletype, '_')))[,1])
d2$kval <- as.factor(t(as.data.frame(strsplit(d2$gambletype, '_')))[,2])
d2$delay_unit <- ifelse(str_detect(d2$delay, 'd'), 'days',
ifelse(str_detect(d2$delay, 'w'), 'weeks',
ifelse(str_detect(d2$delay, 'm'), 'months',
ifelse(str_detect(d2$delay, 'y'), 'years', 0))))
